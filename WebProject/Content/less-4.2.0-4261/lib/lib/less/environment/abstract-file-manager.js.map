{"version":3,"file":"abstract-file-manager.js","sourceRoot":"","sources":["../../../less/environment/abstract-file-manager.js"],"names":[],"mappings":"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","sourcesContent":["\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar AbstractFileManager = /** @class */ (function () {\r\n    function AbstractFileManager() {\r\n    }\r\n    AbstractFileManager.prototype.getPath = function (filename) {\r\n        var j = filename.lastIndexOf('?');\r\n        if (j > 0) {\r\n            filename = filename.slice(0, j);\r\n        }\r\n        j = filename.lastIndexOf('/');\r\n        if (j < 0) {\r\n            j = filename.lastIndexOf('\\\\');\r\n        }\r\n        if (j < 0) {\r\n            return '';\r\n        }\r\n        return filename.slice(0, j + 1);\r\n    };\r\n    AbstractFileManager.prototype.tryAppendExtension = function (path, ext) {\r\n        return /(\\.[a-z]*$)|([?;].*)$/.test(path) ? path : path + ext;\r\n    };\r\n    AbstractFileManager.prototype.tryAppendLessExtension = function (path) {\r\n        return this.tryAppendExtension(path, '.less');\r\n    };\r\n    AbstractFileManager.prototype.supportsSync = function () {\r\n        return false;\r\n    };\r\n    AbstractFileManager.prototype.alwaysMakePathsAbsolute = function () {\r\n        return false;\r\n    };\r\n    AbstractFileManager.prototype.isPathAbsolute = function (filename) {\r\n        return (/^(?:[a-z-]+:|\\/|\\\\|#)/i).test(filename);\r\n    };\r\n    // TODO: pull out / replace?\r\n    AbstractFileManager.prototype.join = function (basePath, laterPath) {\r\n        if (!basePath) {\r\n            return laterPath;\r\n        }\r\n        return basePath + laterPath;\r\n    };\r\n    AbstractFileManager.prototype.pathDiff = function (url, baseUrl) {\r\n        // diff between two paths to create a relative path\r\n        var urlParts = this.extractUrlParts(url);\r\n        var baseUrlParts = this.extractUrlParts(baseUrl);\r\n        var i;\r\n        var max;\r\n        var urlDirectories;\r\n        var baseUrlDirectories;\r\n        var diff = '';\r\n        if (urlParts.hostPart !== baseUrlParts.hostPart) {\r\n            return '';\r\n        }\r\n        max = Math.max(baseUrlParts.directories.length, urlParts.directories.length);\r\n        for (i = 0; i < max; i++) {\r\n            if (baseUrlParts.directories[i] !== urlParts.directories[i]) {\r\n                break;\r\n            }\r\n        }\r\n        baseUrlDirectories = baseUrlParts.directories.slice(i);\r\n        urlDirectories = urlParts.directories.slice(i);\r\n        for (i = 0; i < baseUrlDirectories.length - 1; i++) {\r\n            diff += '../';\r\n        }\r\n        for (i = 0; i < urlDirectories.length - 1; i++) {\r\n            diff += \"\".concat(urlDirectories[i], \"/\");\r\n        }\r\n        return diff;\r\n    };\r\n    /**\r\n     * Helper function, not part of API.\r\n     * This should be replaceable by newer Node / Browser APIs\r\n     *\r\n     * @param {string} url\r\n     * @param {string} baseUrl\r\n     */\r\n    AbstractFileManager.prototype.extractUrlParts = function (url, baseUrl) {\r\n        // urlParts[1] = protocol://hostname/ OR /\r\n        // urlParts[2] = / if path relative to host base\r\n        // urlParts[3] = directories\r\n        // urlParts[4] = filename\r\n        // urlParts[5] = parameters\r\n        var urlPartsRegex = /^((?:[a-z-]+:)?\\/{2}(?:[^/?#]*\\/)|([/\\\\]))?((?:[^/\\\\?#]*[/\\\\])*)([^/\\\\?#]*)([#?].*)?$/i;\r\n        var urlParts = url.match(urlPartsRegex);\r\n        var returner = {};\r\n        var rawDirectories = [];\r\n        var directories = [];\r\n        var i;\r\n        var baseUrlParts;\r\n        if (!urlParts) {\r\n            throw new Error(\"Could not parse sheet href - '\".concat(url, \"'\"));\r\n        }\r\n        // Stylesheets in IE don't always return the full path\r\n        if (baseUrl && (!urlParts[1] || urlParts[2])) {\r\n            baseUrlParts = baseUrl.match(urlPartsRegex);\r\n            if (!baseUrlParts) {\r\n                throw new Error(\"Could not parse page url - '\".concat(baseUrl, \"'\"));\r\n            }\r\n            urlParts[1] = urlParts[1] || baseUrlParts[1] || '';\r\n            if (!urlParts[2]) {\r\n                urlParts[3] = baseUrlParts[3] + urlParts[3];\r\n            }\r\n        }\r\n        if (urlParts[3]) {\r\n            rawDirectories = urlParts[3].replace(/\\\\/g, '/').split('/');\r\n            // collapse '..' and skip '.'\r\n            for (i = 0; i < rawDirectories.length; i++) {\r\n                if (rawDirectories[i] === '..') {\r\n                    directories.pop();\r\n                }\r\n                else if (rawDirectories[i] !== '.') {\r\n                    directories.push(rawDirectories[i]);\r\n                }\r\n            }\r\n        }\r\n        returner.hostPart = urlParts[1];\r\n        returner.directories = directories;\r\n        returner.rawPath = (urlParts[1] || '') + rawDirectories.join('/');\r\n        returner.path = (urlParts[1] || '') + directories.join('/');\r\n        returner.filename = urlParts[4];\r\n        returner.fileUrl = returner.path + (urlParts[4] || '');\r\n        returner.url = returner.fileUrl + (urlParts[5] || '');\r\n        return returner;\r\n    };\r\n    return AbstractFileManager;\r\n}());\r\nexports.default = AbstractFileManager;\r\n//# sourceMappingURL=abstract-file-manager.js.map"]}