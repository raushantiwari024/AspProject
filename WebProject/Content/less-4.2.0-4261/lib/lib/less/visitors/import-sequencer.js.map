{"version":3,"file":"import-sequencer.js","sourceRoot":"","sources":["../../../less/visitors/import-sequencer.js"],"names":[],"mappings":"AAAA,YAAY,CAAC;AACb,MAAM,CAAC,cAAc,CAAC,OAAO,EAAE,YAAY,EAAE,EAAE,KAAK,EAAE,IAAI,EAAE,CAAC,CAAC;AAC9D,IAAI,eAAe,GAAG,aAAa,CAAC,CAAC;IACjC,SAAS,eAAe,CAAC,gBAAgB;QACrC,IAAI,CAAC,OAAO,GAAG,EAAE,CAAC;QAClB,IAAI,CAAC,eAAe,GAAG,EAAE,CAAC;QAC1B,IAAI,CAAC,iBAAiB,GAAG,gBAAgB,CAAC;QAC1C,IAAI,CAAC,aAAa,GAAG,CAAC,CAAC;IAC3B,CAAC;IACD,eAAe,CAAC,SAAS,CAAC,SAAS,GAAG,UAAU,QAAQ;QACpD,IAAI,eAAe,GAAG,IAAI,EAAE,UAAU,GAAG;YACrC,QAAQ,EAAE,QAAQ;YAClB,IAAI,EAAE,IAAI;YACV,OAAO,EAAE,KAAK;SACjB,CAAC;QACF,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,UAAU,CAAC,CAAC;QAC9B,OAAO;YACH,UAAU,CAAC,IAAI,GAAG,KAAK,CAAC,SAAS,CAAC,KAAK,CAAC,IAAI,CAAC,SAAS,EAAE,CAAC,CAAC,CAAC;YAC3D,UAAU,CAAC,OAAO,GAAG,IAAI,CAAC;YAC1B,eAAe,CAAC,MAAM,EAAE,CAAC;QAC7B,CAAC,CAAC;IACN,CAAC,CAAC;IACF,eAAe,CAAC,SAAS,CAAC,iBAAiB,GAAG,UAAU,QAAQ;QAC5D,IAAI,CAAC,eAAe,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAC;IACxC,CAAC,CAAC;IACF,eAAe,CAAC,SAAS,CAAC,MAAM,GAAG;QAC/B,IAAI,CAAC,aAAa,EAAE,CAAC;QACrB,IAAI,CAAC;YACD,OAAO,IAAI,EAAE,CAAC;gBACV,OAAO,IAAI,CAAC,OAAO,CAAC,MAAM,GAAG,CAAC,EAAE,CAAC;oBAC7B,IAAI,UAAU,GAAG,IAAI,CAAC,OAAO,CAAC,CAAC,CAAC,CAAC;oBACjC,IAAI,CAAC,UAAU,CAAC,OAAO,EAAE,CAAC;wBACtB,OAAO;oBACX,CAAC;oBACD,IAAI,CAAC,OAAO,GAAG,IAAI,CAAC,OAAO,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC;oBACrC,UAAU,CAAC,QAAQ,CAAC,KAAK,CAAC,IAAI,EAAE,UAAU,CAAC,IAAI,CAAC,CAAC;gBACrD,CAAC;gBACD,IAAI,IAAI,CAAC,eAAe,CAAC,MAAM,KAAK,CAAC,EAAE,CAAC;oBACpC,MAAM;gBACV,CAAC;gBACD,IAAI,cAAc,GAAG,IAAI,CAAC,eAAe,CAAC,CAAC,CAAC,CAAC;gBAC7C,IAAI,CAAC,eAAe,GAAG,IAAI,CAAC,eAAe,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC;gBACrD,cAAc,EAAE,CAAC;YACrB,CAAC;QACL,CAAC;gBACO,CAAC;YACL,IAAI,CAAC,aAAa,EAAE,CAAC;QACzB,CAAC;QACD,IAAI,IAAI,CAAC,aAAa,KAAK,CAAC,IAAI,IAAI,CAAC,iBAAiB,EAAE,CAAC;YACrD,IAAI,CAAC,iBAAiB,EAAE,CAAC;QAC7B,CAAC;IACL,CAAC,CAAC;IACF,OAAO,eAAe,CAAC;AAC3B,CAAC,EAAE,CAAC,CAAC;AACL,OAAO,CAAC,OAAO,GAAG,eAAe,CAAC","sourcesContent":["\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar ImportSequencer = /** @class */ (function () {\r\n    function ImportSequencer(onSequencerEmpty) {\r\n        this.imports = [];\r\n        this.variableImports = [];\r\n        this._onSequencerEmpty = onSequencerEmpty;\r\n        this._currentDepth = 0;\r\n    }\r\n    ImportSequencer.prototype.addImport = function (callback) {\r\n        var importSequencer = this, importItem = {\r\n            callback: callback,\r\n            args: null,\r\n            isReady: false\r\n        };\r\n        this.imports.push(importItem);\r\n        return function () {\r\n            importItem.args = Array.prototype.slice.call(arguments, 0);\r\n            importItem.isReady = true;\r\n            importSequencer.tryRun();\r\n        };\r\n    };\r\n    ImportSequencer.prototype.addVariableImport = function (callback) {\r\n        this.variableImports.push(callback);\r\n    };\r\n    ImportSequencer.prototype.tryRun = function () {\r\n        this._currentDepth++;\r\n        try {\r\n            while (true) {\r\n                while (this.imports.length > 0) {\r\n                    var importItem = this.imports[0];\r\n                    if (!importItem.isReady) {\r\n                        return;\r\n                    }\r\n                    this.imports = this.imports.slice(1);\r\n                    importItem.callback.apply(null, importItem.args);\r\n                }\r\n                if (this.variableImports.length === 0) {\r\n                    break;\r\n                }\r\n                var variableImport = this.variableImports[0];\r\n                this.variableImports = this.variableImports.slice(1);\r\n                variableImport();\r\n            }\r\n        }\r\n        finally {\r\n            this._currentDepth--;\r\n        }\r\n        if (this._currentDepth === 0 && this._onSequencerEmpty) {\r\n            this._onSequencerEmpty();\r\n        }\r\n    };\r\n    return ImportSequencer;\r\n}());\r\nexports.default = ImportSequencer;\r\n//# sourceMappingURL=import-sequencer.js.map"]}