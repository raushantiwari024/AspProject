{"version":3,"file":"contexts.js","sourceRoot":"","sources":["../../less/contexts.js"],"names":[],"mappings":"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","sourcesContent":["\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar tslib_1 = require(\"tslib\");\r\nvar contexts = {};\r\nexports.default = contexts;\r\nvar Constants = tslib_1.__importStar(require(\"./constants\"));\r\nvar copyFromOriginal = function copyFromOriginal(original, destination, propertiesToCopy) {\r\n    if (!original) {\r\n        return;\r\n    }\r\n    for (var i = 0; i < propertiesToCopy.length; i++) {\r\n        if (Object.prototype.hasOwnProperty.call(original, propertiesToCopy[i])) {\r\n            destination[propertiesToCopy[i]] = original[propertiesToCopy[i]];\r\n        }\r\n    }\r\n};\r\n/*\r\n parse is used whilst parsing\r\n */\r\nvar parseCopyProperties = [\r\n    // options\r\n    'paths',\r\n    'rewriteUrls',\r\n    'rootpath',\r\n    'strictImports',\r\n    'insecure',\r\n    'dumpLineNumbers',\r\n    'compress',\r\n    'syncImport',\r\n    'chunkInput',\r\n    'mime',\r\n    'useFileCache',\r\n    // context\r\n    'processImports',\r\n    // Used by the import manager to stop multiple import visitors being created.\r\n    'pluginManager' // Used as the plugin manager for the session\r\n];\r\ncontexts.Parse = function (options) {\r\n    copyFromOriginal(options, this, parseCopyProperties);\r\n    if (typeof this.paths === 'string') {\r\n        this.paths = [this.paths];\r\n    }\r\n};\r\nvar evalCopyProperties = [\r\n    'paths',\r\n    'compress',\r\n    'math',\r\n    'strictUnits',\r\n    'sourceMap',\r\n    'importMultiple',\r\n    'urlArgs',\r\n    'javascriptEnabled',\r\n    'pluginManager',\r\n    'importantScope',\r\n    'rewriteUrls' // option - whether to adjust URL's to be relative\r\n];\r\ncontexts.Eval = function (options, frames) {\r\n    copyFromOriginal(options, this, evalCopyProperties);\r\n    if (typeof this.paths === 'string') {\r\n        this.paths = [this.paths];\r\n    }\r\n    this.frames = frames || [];\r\n    this.importantScope = this.importantScope || [];\r\n};\r\ncontexts.Eval.prototype.enterCalc = function () {\r\n    if (!this.calcStack) {\r\n        this.calcStack = [];\r\n    }\r\n    this.calcStack.push(true);\r\n    this.inCalc = true;\r\n};\r\ncontexts.Eval.prototype.exitCalc = function () {\r\n    this.calcStack.pop();\r\n    if (!this.calcStack.length) {\r\n        this.inCalc = false;\r\n    }\r\n};\r\ncontexts.Eval.prototype.inParenthesis = function () {\r\n    if (!this.parensStack) {\r\n        this.parensStack = [];\r\n    }\r\n    this.parensStack.push(true);\r\n};\r\ncontexts.Eval.prototype.outOfParenthesis = function () {\r\n    this.parensStack.pop();\r\n};\r\ncontexts.Eval.prototype.inCalc = false;\r\ncontexts.Eval.prototype.mathOn = true;\r\ncontexts.Eval.prototype.isMathOn = function (op) {\r\n    if (!this.mathOn) {\r\n        return false;\r\n    }\r\n    if (op === '/' && this.math !== Constants.Math.ALWAYS && (!this.parensStack || !this.parensStack.length)) {\r\n        return false;\r\n    }\r\n    if (this.math > Constants.Math.PARENS_DIVISION) {\r\n        return this.parensStack && this.parensStack.length;\r\n    }\r\n    return true;\r\n};\r\ncontexts.Eval.prototype.pathRequiresRewrite = function (path) {\r\n    var isRelative = this.rewriteUrls === Constants.RewriteUrls.LOCAL ? isPathLocalRelative : isPathRelative;\r\n    return isRelative(path);\r\n};\r\ncontexts.Eval.prototype.rewritePath = function (path, rootpath) {\r\n    var newPath;\r\n    rootpath = rootpath || '';\r\n    newPath = this.normalizePath(rootpath + path);\r\n    // If a path was explicit relative and the rootpath was not an absolute path\r\n    // we must ensure that the new path is also explicit relative.\r\n    if (isPathLocalRelative(path) &&\r\n        isPathRelative(rootpath) &&\r\n        isPathLocalRelative(newPath) === false) {\r\n        newPath = \"./\".concat(newPath);\r\n    }\r\n    return newPath;\r\n};\r\ncontexts.Eval.prototype.normalizePath = function (path) {\r\n    var segments = path.split('/').reverse();\r\n    var segment;\r\n    path = [];\r\n    while (segments.length !== 0) {\r\n        segment = segments.pop();\r\n        switch (segment) {\r\n            case '.':\r\n                break;\r\n            case '..':\r\n                if ((path.length === 0) || (path[path.length - 1] === '..')) {\r\n                    path.push(segment);\r\n                }\r\n                else {\r\n                    path.pop();\r\n                }\r\n                break;\r\n            default:\r\n                path.push(segment);\r\n                break;\r\n        }\r\n    }\r\n    return path.join('/');\r\n};\r\nfunction isPathRelative(path) {\r\n    return !/^(?:[a-z-]+:|\\/|#)/i.test(path);\r\n}\r\nfunction isPathLocalRelative(path) {\r\n    return path.charAt(0) === '.';\r\n}\r\n// todo - do the same for the toCSS ?\r\n//# sourceMappingURL=contexts.js.map"]}