{"version":3,"file":"mixin-definition.js","sourceRoot":"","sources":["../../../less/tree/mixin-definition.js"],"names":[],"mappings":"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","sourcesContent":["\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar tslib_1 = require(\"tslib\");\r\nvar selector_1 = tslib_1.__importDefault(require(\"./selector\"));\r\nvar element_1 = tslib_1.__importDefault(require(\"./element\"));\r\nvar ruleset_1 = tslib_1.__importDefault(require(\"./ruleset\"));\r\nvar declaration_1 = tslib_1.__importDefault(require(\"./declaration\"));\r\nvar detached_ruleset_1 = tslib_1.__importDefault(require(\"./detached-ruleset\"));\r\nvar expression_1 = tslib_1.__importDefault(require(\"./expression\"));\r\nvar contexts_1 = tslib_1.__importDefault(require(\"../contexts\"));\r\nvar utils = tslib_1.__importStar(require(\"../utils\"));\r\nvar Definition = function (name, params, rules, condition, variadic, frames, visibilityInfo) {\r\n    this.name = name || 'anonymous mixin';\r\n    this.selectors = [new selector_1.default([new element_1.default(null, name, false, this._index, this._fileInfo)])];\r\n    this.params = params;\r\n    this.condition = condition;\r\n    this.variadic = variadic;\r\n    this.arity = params.length;\r\n    this.rules = rules;\r\n    this._lookups = {};\r\n    var optionalParameters = [];\r\n    this.required = params.reduce(function (count, p) {\r\n        if (!p.name || (p.name && !p.value)) {\r\n            return count + 1;\r\n        }\r\n        else {\r\n            optionalParameters.push(p.name);\r\n            return count;\r\n        }\r\n    }, 0);\r\n    this.optionalParameters = optionalParameters;\r\n    this.frames = frames;\r\n    this.copyVisibilityInfo(visibilityInfo);\r\n    this.allowRoot = true;\r\n};\r\nDefinition.prototype = Object.assign(new ruleset_1.default(), {\r\n    type: 'MixinDefinition',\r\n    evalFirst: true,\r\n    accept: function (visitor) {\r\n        if (this.params && this.params.length) {\r\n            this.params = visitor.visitArray(this.params);\r\n        }\r\n        this.rules = visitor.visitArray(this.rules);\r\n        if (this.condition) {\r\n            this.condition = visitor.visit(this.condition);\r\n        }\r\n    },\r\n    evalParams: function (context, mixinEnv, args, evaldArguments) {\r\n        /* jshint boss:true */\r\n        var frame = new ruleset_1.default(null, null);\r\n        var varargs;\r\n        var arg;\r\n        var params = utils.copyArray(this.params);\r\n        var i;\r\n        var j;\r\n        var val;\r\n        var name;\r\n        var isNamedFound;\r\n        var argIndex;\r\n        var argsLength = 0;\r\n        if (mixinEnv.frames && mixinEnv.frames[0] && mixinEnv.frames[0].functionRegistry) {\r\n            frame.functionRegistry = mixinEnv.frames[0].functionRegistry.inherit();\r\n        }\r\n        mixinEnv = new contexts_1.default.Eval(mixinEnv, [frame].concat(mixinEnv.frames));\r\n        if (args) {\r\n            args = utils.copyArray(args);\r\n            argsLength = args.length;\r\n            for (i = 0; i < argsLength; i++) {\r\n                arg = args[i];\r\n                if (name = (arg && arg.name)) {\r\n                    isNamedFound = false;\r\n                    for (j = 0; j < params.length; j++) {\r\n                        if (!evaldArguments[j] && name === params[j].name) {\r\n                            evaldArguments[j] = arg.value.eval(context);\r\n                            frame.prependRule(new declaration_1.default(name, arg.value.eval(context)));\r\n                            isNamedFound = true;\r\n                            break;\r\n                        }\r\n                    }\r\n                    if (isNamedFound) {\r\n                        args.splice(i, 1);\r\n                        i--;\r\n                        continue;\r\n                    }\r\n                    else {\r\n                        throw { type: 'Runtime', message: \"Named argument for \".concat(this.name, \" \").concat(args[i].name, \" not found\") };\r\n                    }\r\n                }\r\n            }\r\n        }\r\n        argIndex = 0;\r\n        for (i = 0; i < params.length; i++) {\r\n            if (evaldArguments[i]) {\r\n                continue;\r\n            }\r\n            arg = args && args[argIndex];\r\n            if (name = params[i].name) {\r\n                if (params[i].variadic) {\r\n                    varargs = [];\r\n                    for (j = argIndex; j < argsLength; j++) {\r\n                        varargs.push(args[j].value.eval(context));\r\n                    }\r\n                    frame.prependRule(new declaration_1.default(name, new expression_1.default(varargs).eval(context)));\r\n                }\r\n                else {\r\n                    val = arg && arg.value;\r\n                    if (val) {\r\n                        // This was a mixin call, pass in a detached ruleset of it's eval'd rules\r\n                        if (Array.isArray(val)) {\r\n                            val = new detached_ruleset_1.default(new ruleset_1.default('', val));\r\n                        }\r\n                        else {\r\n                            val = val.eval(context);\r\n                        }\r\n                    }\r\n                    else if (params[i].value) {\r\n                        val = params[i].value.eval(mixinEnv);\r\n                        frame.resetCache();\r\n                    }\r\n                    else {\r\n                        throw { type: 'Runtime', message: \"wrong number of arguments for \".concat(this.name, \" (\").concat(argsLength, \" for \").concat(this.arity, \")\") };\r\n                    }\r\n                    frame.prependRule(new declaration_1.default(name, val));\r\n                    evaldArguments[i] = val;\r\n                }\r\n            }\r\n            if (params[i].variadic && args) {\r\n                for (j = argIndex; j < argsLength; j++) {\r\n                    evaldArguments[j] = args[j].value.eval(context);\r\n                }\r\n            }\r\n            argIndex++;\r\n        }\r\n        return frame;\r\n    },\r\n    makeImportant: function () {\r\n        var rules = !this.rules ? this.rules : this.rules.map(function (r) {\r\n            if (r.makeImportant) {\r\n                return r.makeImportant(true);\r\n            }\r\n            else {\r\n                return r;\r\n            }\r\n        });\r\n        var result = new Definition(this.name, this.params, rules, this.condition, this.variadic, this.frames);\r\n        return result;\r\n    },\r\n    eval: function (context) {\r\n        return new Definition(this.name, this.params, this.rules, this.condition, this.variadic, this.frames || utils.copyArray(context.frames));\r\n    },\r\n    evalCall: function (context, args, important) {\r\n        var _arguments = [];\r\n        var mixinFrames = this.frames ? this.frames.concat(context.frames) : context.frames;\r\n        var frame = this.evalParams(context, new contexts_1.default.Eval(context, mixinFrames), args, _arguments);\r\n        var rules;\r\n        var ruleset;\r\n        frame.prependRule(new declaration_1.default('@arguments', new expression_1.default(_arguments).eval(context)));\r\n        rules = utils.copyArray(this.rules);\r\n        ruleset = new ruleset_1.default(null, rules);\r\n        ruleset.originalRuleset = this;\r\n        ruleset = ruleset.eval(new contexts_1.default.Eval(context, [this, frame].concat(mixinFrames)));\r\n        if (important) {\r\n            ruleset = ruleset.makeImportant();\r\n        }\r\n        return ruleset;\r\n    },\r\n    matchCondition: function (args, context) {\r\n        if (this.condition && !this.condition.eval(new contexts_1.default.Eval(context, [this.evalParams(context, /* the parameter variables */ new contexts_1.default.Eval(context, this.frames ? this.frames.concat(context.frames) : context.frames), args, [])]\r\n            .concat(this.frames || []) // the parent namespace/mixin frames\r\n            .concat(context.frames)))) { // the current environment frames\r\n            return false;\r\n        }\r\n        return true;\r\n    },\r\n    matchArgs: function (args, context) {\r\n        var allArgsCnt = (args && args.length) || 0;\r\n        var len;\r\n        var optionalParameters = this.optionalParameters;\r\n        var requiredArgsCnt = !args ? 0 : args.reduce(function (count, p) {\r\n            if (optionalParameters.indexOf(p.name) < 0) {\r\n                return count + 1;\r\n            }\r\n            else {\r\n                return count;\r\n            }\r\n        }, 0);\r\n        if (!this.variadic) {\r\n            if (requiredArgsCnt < this.required) {\r\n                return false;\r\n            }\r\n            if (allArgsCnt > this.params.length) {\r\n                return false;\r\n            }\r\n        }\r\n        else {\r\n            if (requiredArgsCnt < (this.required - 1)) {\r\n                return false;\r\n            }\r\n        }\r\n        // check patterns\r\n        len = Math.min(requiredArgsCnt, this.arity);\r\n        for (var i = 0; i < len; i++) {\r\n            if (!this.params[i].name && !this.params[i].variadic) {\r\n                if (args[i].value.eval(context).toCSS() != this.params[i].value.eval(context).toCSS()) {\r\n                    return false;\r\n                }\r\n            }\r\n        }\r\n        return true;\r\n    }\r\n});\r\nexports.default = Definition;\r\n//# sourceMappingURL=mixin-definition.js.map"]}