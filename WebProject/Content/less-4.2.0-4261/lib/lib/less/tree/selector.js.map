{"version":3,"file":"selector.js","sourceRoot":"","sources":["../../../less/tree/selector.js"],"names":[],"mappings":"AAAA,YAAY,CAAC;AACb,MAAM,CAAC,cAAc,CAAC,OAAO,EAAE,YAAY,EAAE,EAAE,KAAK,EAAE,IAAI,EAAE,CAAC,CAAC;AAC9D,IAAI,OAAO,GAAG,OAAO,CAAC,OAAO,CAAC,CAAC;AAC/B,IAAI,MAAM,GAAG,OAAO,CAAC,eAAe,CAAC,OAAO,CAAC,QAAQ,CAAC,CAAC,CAAC;AACxD,IAAI,SAAS,GAAG,OAAO,CAAC,eAAe,CAAC,OAAO,CAAC,WAAW,CAAC,CAAC,CAAC;AAC9D,IAAI,YAAY,GAAG,OAAO,CAAC,eAAe,CAAC,OAAO,CAAC,eAAe,CAAC,CAAC,CAAC;AACrE,IAAI,KAAK,GAAG,OAAO,CAAC,YAAY,CAAC,OAAO,CAAC,UAAU,CAAC,CAAC,CAAC;AACtD,IAAI,QAAQ,GAAG,OAAO,CAAC,eAAe,CAAC,OAAO,CAAC,kBAAkB,CAAC,CAAC,CAAC;AACpE,IAAI,QAAQ,GAAG,UAAU,QAAQ,EAAE,UAAU,EAAE,SAAS,EAAE,KAAK,EAAE,eAAe,EAAE,cAAc;IAC5F,IAAI,CAAC,UAAU,GAAG,UAAU,CAAC;IAC7B,IAAI,CAAC,SAAS,GAAG,SAAS,CAAC;IAC3B,IAAI,CAAC,cAAc,GAAG,CAAC,SAAS,CAAC;IACjC,IAAI,CAAC,MAAM,GAAG,KAAK,CAAC;IACpB,IAAI,CAAC,SAAS,GAAG,eAAe,CAAC;IACjC,IAAI,CAAC,QAAQ,GAAG,IAAI,CAAC,WAAW,CAAC,QAAQ,CAAC,CAAC;IAC3C,IAAI,CAAC,cAAc,GAAG,SAAS,CAAC;IAChC,IAAI,CAAC,kBAAkB,CAAC,cAAc,CAAC,CAAC;IACxC,IAAI,CAAC,SAAS,CAAC,IAAI,CAAC,QAAQ,EAAE,IAAI,CAAC,CAAC;AACxC,CAAC,CAAC;AACF,QAAQ,CAAC,SAAS,GAAG,MAAM,CAAC,MAAM,CAAC,IAAI,MAAM,CAAC,OAAO,EAAE,EAAE;IACrD,IAAI,EAAE,UAAU;IAChB,MAAM,EAAE,UAAU,OAAO;QACrB,IAAI,IAAI,CAAC,QAAQ,EAAE,CAAC;YAChB,IAAI,CAAC,QAAQ,GAAG,OAAO,CAAC,UAAU,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAC;QACtD,CAAC;QACD,IAAI,IAAI,CAAC,UAAU,EAAE,CAAC;YAClB,IAAI,CAAC,UAAU,GAAG,OAAO,CAAC,UAAU,CAAC,IAAI,CAAC,UAAU,CAAC,CAAC;QAC1D,CAAC;QACD,IAAI,IAAI,CAAC,SAAS,EAAE,CAAC;YACjB,IAAI,CAAC,SAAS,GAAG,OAAO,CAAC,KAAK,CAAC,IAAI,CAAC,SAAS,CAAC,CAAC;QACnD,CAAC;IACL,CAAC;IACD,aAAa,EAAE,UAAU,QAAQ,EAAE,UAAU,EAAE,cAAc;QACzD,QAAQ,GAAG,IAAI,CAAC,WAAW,CAAC,QAAQ,CAAC,CAAC;QACtC,IAAI,WAAW,GAAG,IAAI,QAAQ,CAAC,QAAQ,EAAE,UAAU,IAAI,IAAI,CAAC,UAAU,EAAE,IAAI,EAAE,IAAI,CAAC,QAAQ,EAAE,EAAE,IAAI,CAAC,QAAQ,EAAE,EAAE,IAAI,CAAC,cAAc,EAAE,CAAC,CAAC;QACvI,WAAW,CAAC,cAAc,GAAG,CAAC,CAAC,KAAK,CAAC,iBAAiB,CAAC,cAAc,CAAC,CAAC,CAAC,CAAC,CAAC,cAAc,CAAC,CAAC,CAAC,IAAI,CAAC,cAAc,CAAC;QAC/G,WAAW,CAAC,UAAU,GAAG,IAAI,CAAC,UAAU,CAAC;QACzC,OAAO,WAAW,CAAC;IACvB,CAAC;IACD,WAAW,EAAE,UAAU,GAAG;QACtB,IAAI,CAAC,GAAG,EAAE,CAAC;YACP,OAAO,CAAC,IAAI,SAAS,CAAC,OAAO,CAAC,EAAE,EAAE,GAAG,EAAE,KAAK,EAAE,IAAI,CAAC,MAAM,EAAE,IAAI,CAAC,SAAS,CAAC,CAAC,CAAC;QAChF,CAAC;QACD,IAAI,OAAO,GAAG,KAAK,QAAQ,EAAE,CAAC;YAC1B,IAAI,QAAQ,CAAC,OAAO,CAAC,IAAI,CAAC,KAAK,CAAC,OAAO,EAAE,IAAI,CAAC,KAAK,CAAC,aAAa,EAAE,IAAI,CAAC,SAAS,EAAE,IAAI,CAAC,MAAM,CAAC,CAAC,SAAS,CAAC,GAAG,EAAE,CAAC,UAAU,CAAC,EAAE,UAAU,GAAG,EAAE,MAAM;gBAC9I,IAAI,GAAG,EAAE,CAAC;oBACN,MAAM,IAAI,YAAY,CAAC,OAAO,CAAC;wBAC3B,KAAK,EAAE,GAAG,CAAC,KAAK;wBAChB,OAAO,EAAE,GAAG,CAAC,OAAO;qBACvB,EAAE,IAAI,CAAC,KAAK,CAAC,OAAO,EAAE,IAAI,CAAC,SAAS,CAAC,QAAQ,CAAC,CAAC;gBACpD,CAAC;gBACD,GAAG,GAAG,MAAM,CAAC,CAAC,CAAC,CAAC,QAAQ,CAAC;YAC7B,CAAC,CAAC,CAAC;QACP,CAAC;QACD,OAAO,GAAG,CAAC;IACf,CAAC;IACD,oBAAoB,EAAE;QAClB,IAAI,EAAE,GAAG,IAAI,SAAS,CAAC,OAAO,CAAC,EAAE,EAAE,GAAG,EAAE,KAAK,EAAE,IAAI,CAAC,MAAM,EAAE,IAAI,CAAC,SAAS,CAAC,EAAE,IAAI,GAAG,CAAC,IAAI,QAAQ,CAAC,CAAC,EAAE,CAAC,EAAE,IAAI,EAAE,IAAI,EAAE,IAAI,CAAC,MAAM,EAAE,IAAI,CAAC,SAAS,CAAC,CAAC,CAAC;QAClJ,IAAI,CAAC,CAAC,CAAC,CAAC,UAAU,GAAG,IAAI,CAAC;QAC1B,OAAO,IAAI,CAAC;IAChB,CAAC;IACD,KAAK,EAAE,UAAU,KAAK;QAClB,IAAI,QAAQ,GAAG,IAAI,CAAC,QAAQ,CAAC;QAC7B,IAAI,GAAG,GAAG,QAAQ,CAAC,MAAM,CAAC;QAC1B,IAAI,IAAI,CAAC;QACT,IAAI,CAAC,CAAC;QACN,KAAK,GAAG,KAAK,CAAC,aAAa,EAAE,CAAC;QAC9B,IAAI,GAAG,KAAK,CAAC,MAAM,CAAC;QACpB,IAAI,IAAI,KAAK,CAAC,IAAI,GAAG,GAAG,IAAI,EAAE,CAAC;YAC3B,OAAO,CAAC,CAAC;QACb,CAAC;aACI,CAAC;YACF,KAAK,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,IAAI,EAAE,CAAC,EAAE,EAAE,CAAC;gBACxB,IAAI,QAAQ,CAAC,CAAC,CAAC,CAAC,KAAK,KAAK,KAAK,CAAC,CAAC,CAAC,EAAE,CAAC;oBACjC,OAAO,CAAC,CAAC;gBACb,CAAC;YACL,CAAC;QACL,CAAC;QACD,OAAO,IAAI,CAAC,CAAC,oCAAoC;IACrD,CAAC;IACD,aAAa,EAAE;QACX,IAAI,IAAI,CAAC,cAAc,EAAE,CAAC;YACtB,OAAO,IAAI,CAAC,cAAc,CAAC;QAC/B,CAAC;QACD,IAAI,QAAQ,GAAG,IAAI,CAAC,QAAQ,CAAC,GAAG,CAAC,UAAU,CAAC;YACxC,OAAO,CAAC,CAAC,UAAU,CAAC,KAAK,GAAG,CAAC,CAAC,CAAC,KAAK,CAAC,KAAK,IAAI,CAAC,CAAC,KAAK,CAAC,CAAC;QAC3D,CAAC,CAAC,CAAC,IAAI,CAAC,EAAE,CAAC,CAAC,KAAK,CAAC,2BAA2B,CAAC,CAAC;QAC/C,IAAI,QAAQ,EAAE,CAAC;YACX,IAAI,QAAQ,CAAC,CAAC,CAAC,KAAK,GAAG,EAAE,CAAC;gBACtB,QAAQ,CAAC,KAAK,EAAE,CAAC;YACrB,CAAC;QACL,CAAC;aACI,CAAC;YACF,QAAQ,GAAG,EAAE,CAAC;QAClB,CAAC;QACD,OAAO,CAAC,IAAI,CAAC,cAAc,GAAG,QAAQ,CAAC,CAAC;IAC5C,CAAC;IACD,oBAAoB,EAAE;QAClB,OAAO,CAAC,IAAI,CAAC,UAAU;YACnB,IAAI,CAAC,QAAQ,CAAC,MAAM,KAAK,CAAC;YAC1B,IAAI,CAAC,QAAQ,CAAC,CAAC,CAAC,CAAC,KAAK,KAAK,GAAG;YAC9B,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAC,CAAC,CAAC,UAAU,CAAC,KAAK,KAAK,GAAG,IAAI,IAAI,CAAC,QAAQ,CAAC,CAAC,CAAC,CAAC,UAAU,CAAC,KAAK,KAAK,EAAE,CAAC,CAAC;IAChG,CAAC;IACD,IAAI,EAAE,UAAU,OAAO;QACnB,IAAI,cAAc,GAAG,IAAI,CAAC,SAAS,IAAI,IAAI,CAAC,SAAS,CAAC,IAAI,CAAC,OAAO,CAAC,CAAC;QACpE,IAAI,QAAQ,GAAG,IAAI,CAAC,QAAQ,CAAC;QAC7B,IAAI,UAAU,GAAG,IAAI,CAAC,UAAU,CAAC;QACjC,QAAQ,GAAG,QAAQ,IAAI,QAAQ,CAAC,GAAG,CAAC,UAAU,CAAC,IAAI,OAAO,CAAC,CAAC,IAAI,CAAC,OAAO,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;QAC9E,UAAU,GAAG,UAAU,IAAI,UAAU,CAAC,GAAG,CAAC,UAAU,MAAM,IAAI,OAAO,MAAM,CAAC,IAAI,CAAC,OAAO,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;QAC9F,OAAO,IAAI,CAAC,aAAa,CAAC,QAAQ,EAAE,UAAU,EAAE,cAAc,CAAC,CAAC;IACpE,CAAC;IACD,MAAM,EAAE,UAAU,OAAO,EAAE,MAAM;QAC7B,IAAI,CAAC,EAAE,OAAO,CAAC;QACf,IAAI,CAAC,CAAC,OAAO,IAAI,CAAC,OAAO,CAAC,aAAa,CAAC,IAAI,IAAI,CAAC,QAAQ,CAAC,CAAC,CAAC,CAAC,UAAU,CAAC,KAAK,KAAK,EAAE,EAAE,CAAC;YACnF,MAAM,CAAC,GAAG,CAAC,GAAG,EAAE,IAAI,CAAC,QAAQ,EAAE,EAAE,IAAI,CAAC,QAAQ,EAAE,CAAC,CAAC;QACtD,CAAC;QACD,KAAK,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,IAAI,CAAC,QAAQ,CAAC,MAAM,EAAE,CAAC,EAAE,EAAE,CAAC;YACxC,OAAO,GAAG,IAAI,CAAC,QAAQ,CAAC,CAAC,CAAC,CAAC;YAC3B,OAAO,CAAC,MAAM,CAAC,OAAO,EAAE,MAAM,CAAC,CAAC;QACpC,CAAC;IACL,CAAC;IACD,WAAW,EAAE;QACT,OAAO,IAAI,CAAC,cAAc,CAAC;IAC/B,CAAC;CACJ,CAAC,CAAC;AACH,OAAO,CAAC,OAAO,GAAG,QAAQ,CAAC","sourcesContent":["\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar tslib_1 = require(\"tslib\");\r\nvar node_1 = tslib_1.__importDefault(require(\"./node\"));\r\nvar element_1 = tslib_1.__importDefault(require(\"./element\"));\r\nvar less_error_1 = tslib_1.__importDefault(require(\"../less-error\"));\r\nvar utils = tslib_1.__importStar(require(\"../utils\"));\r\nvar parser_1 = tslib_1.__importDefault(require(\"../parser/parser\"));\r\nvar Selector = function (elements, extendList, condition, index, currentFileInfo, visibilityInfo) {\r\n    this.extendList = extendList;\r\n    this.condition = condition;\r\n    this.evaldCondition = !condition;\r\n    this._index = index;\r\n    this._fileInfo = currentFileInfo;\r\n    this.elements = this.getElements(elements);\r\n    this.mixinElements_ = undefined;\r\n    this.copyVisibilityInfo(visibilityInfo);\r\n    this.setParent(this.elements, this);\r\n};\r\nSelector.prototype = Object.assign(new node_1.default(), {\r\n    type: 'Selector',\r\n    accept: function (visitor) {\r\n        if (this.elements) {\r\n            this.elements = visitor.visitArray(this.elements);\r\n        }\r\n        if (this.extendList) {\r\n            this.extendList = visitor.visitArray(this.extendList);\r\n        }\r\n        if (this.condition) {\r\n            this.condition = visitor.visit(this.condition);\r\n        }\r\n    },\r\n    createDerived: function (elements, extendList, evaldCondition) {\r\n        elements = this.getElements(elements);\r\n        var newSelector = new Selector(elements, extendList || this.extendList, null, this.getIndex(), this.fileInfo(), this.visibilityInfo());\r\n        newSelector.evaldCondition = (!utils.isNullOrUndefined(evaldCondition)) ? evaldCondition : this.evaldCondition;\r\n        newSelector.mediaEmpty = this.mediaEmpty;\r\n        return newSelector;\r\n    },\r\n    getElements: function (els) {\r\n        if (!els) {\r\n            return [new element_1.default('', '&', false, this._index, this._fileInfo)];\r\n        }\r\n        if (typeof els === 'string') {\r\n            new parser_1.default(this.parse.context, this.parse.importManager, this._fileInfo, this._index).parseNode(els, ['selector'], function (err, result) {\r\n                if (err) {\r\n                    throw new less_error_1.default({\r\n                        index: err.index,\r\n                        message: err.message\r\n                    }, this.parse.imports, this._fileInfo.filename);\r\n                }\r\n                els = result[0].elements;\r\n            });\r\n        }\r\n        return els;\r\n    },\r\n    createEmptySelectors: function () {\r\n        var el = new element_1.default('', '&', false, this._index, this._fileInfo), sels = [new Selector([el], null, null, this._index, this._fileInfo)];\r\n        sels[0].mediaEmpty = true;\r\n        return sels;\r\n    },\r\n    match: function (other) {\r\n        var elements = this.elements;\r\n        var len = elements.length;\r\n        var olen;\r\n        var i;\r\n        other = other.mixinElements();\r\n        olen = other.length;\r\n        if (olen === 0 || len < olen) {\r\n            return 0;\r\n        }\r\n        else {\r\n            for (i = 0; i < olen; i++) {\r\n                if (elements[i].value !== other[i]) {\r\n                    return 0;\r\n                }\r\n            }\r\n        }\r\n        return olen; // return number of matched elements\r\n    },\r\n    mixinElements: function () {\r\n        if (this.mixinElements_) {\r\n            return this.mixinElements_;\r\n        }\r\n        var elements = this.elements.map(function (v) {\r\n            return v.combinator.value + (v.value.value || v.value);\r\n        }).join('').match(/[,&#*.\\w-]([\\w-]|(\\\\.))*/g);\r\n        if (elements) {\r\n            if (elements[0] === '&') {\r\n                elements.shift();\r\n            }\r\n        }\r\n        else {\r\n            elements = [];\r\n        }\r\n        return (this.mixinElements_ = elements);\r\n    },\r\n    isJustParentSelector: function () {\r\n        return !this.mediaEmpty &&\r\n            this.elements.length === 1 &&\r\n            this.elements[0].value === '&' &&\r\n            (this.elements[0].combinator.value === ' ' || this.elements[0].combinator.value === '');\r\n    },\r\n    eval: function (context) {\r\n        var evaldCondition = this.condition && this.condition.eval(context);\r\n        var elements = this.elements;\r\n        var extendList = this.extendList;\r\n        elements = elements && elements.map(function (e) { return e.eval(context); });\r\n        extendList = extendList && extendList.map(function (extend) { return extend.eval(context); });\r\n        return this.createDerived(elements, extendList, evaldCondition);\r\n    },\r\n    genCSS: function (context, output) {\r\n        var i, element;\r\n        if ((!context || !context.firstSelector) && this.elements[0].combinator.value === '') {\r\n            output.add(' ', this.fileInfo(), this.getIndex());\r\n        }\r\n        for (i = 0; i < this.elements.length; i++) {\r\n            element = this.elements[i];\r\n            element.genCSS(context, output);\r\n        }\r\n    },\r\n    getIsOutput: function () {\r\n        return this.evaldCondition;\r\n    }\r\n});\r\nexports.default = Selector;\r\n//# sourceMappingURL=selector.js.map"]}